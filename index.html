<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LoL Search Tools - 汎用ツール</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Barlow:wght@700;900&family=Noto+Sans+JP:wght@400;700;900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="static/css/styles.css" />
  </head>
  <body>
    <div class="container">
      <!-- ヘッダー -->
      <div class="header">
        <h1>🎮 LoL Search Tools</h1>
        <p class="subtitle">League of Legends 汎用ツール</p>
      </div>

      <!-- タブナビゲーション -->
      <div class="tabs">
        <button class="tab-button active" onclick="switchTab('match-history')">
          📊 戦績表示
        </button>
        <button class="tab-button" onclick="switchTab('current-game')">
          🎯 試合情報
        </button>
        <button class="tab-button" onclick="switchTab('balance-teams')">
          ⚖️ 組み分け
        </button>
        <button class="tab-button" onclick="switchTab('runes')">
          🎨 ルーン
        </button>
        <button class="tab-button" onclick="switchTab('champions')">
          🏆 チャンピオン
        </button>
        <button class="tab-button" onclick="switchTab('items')">
          🗡️ アイテム
        </button>
      </div>

      <!-- 戦績表示タブ -->
      <div id="match-history" class="tab-content active">
        <div class="content-card">
          <div class="info-box">
            💡 Riot IDを「ゲーム名#タグライン」形式で入力してください。<br />
            例: PlayerName#JP1
          </div>

          <div class="input-group">
            <label>🎮 Riot ID（ゲーム名#タグライン）</label>
            <input
              type="text"
              id="game-riot-id"
              placeholder="例: PlayerName#JP1"
            />
          </div>

          <button onclick="fetchMatchHistory()">🔍 戦績を取得</button>

          <!-- フィルターセクション -->
          <div id="match-filters" style="display: none; margin-top: 20px;">
            <div class="compact-filters">
              <div class="compact-filters-header">
                <h3>🔍 フィルター</h3>
                <button 
                  onclick="resetMatchFilters()"
                  style="padding: 5px 10px; font-size: 0.85rem;"
                >
                  🗑️ リセット
                </button>
              </div>
              <div class="filter-group">
                <div class="input-group">
                  <label>ゲームモード</label>
                  <select id="filter-mode" onchange="applyFilters()">
                    <option value="">すべて</option>
                    <option value="CLASSIC">ランク/ノーマル</option>
                    <option value="ARAM">ARAM</option>
                    <option value="CHERRY">Arena</option>
                  </select>
                </div>
                <div class="input-group">
                  <label>結果</label>
                  <select id="filter-result" onchange="applyFilters()">
                    <option value="">すべて</option>
                    <option value="win">勝利のみ</option>
                    <option value="loss">敗北のみ</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="loading" id="match-loading">⏳ 読み込み中...</div>
          <div class="error" id="match-error"></div>
          <div class="result" id="match-result"></div>
        </div>
      </div>

      <!-- 試合情報タブ -->
      <div id="current-game" class="tab-content">
        <div class="content-card">
          <div class="info-box">
            🎯 現在プレイ中の試合情報を取得します。<br />
            Riot IDを「ゲーム名#タグライン」形式で入力してください。
          </div>

          <div class="input-group">
            <label>🎮 Riot ID（ゲーム名#タグライン）</label>
            <input
              type="text"
              id="current-game-riot-id"
              placeholder="例: PlayerName#JP1"
            />
          </div>

          <button onclick="fetchCurrentGame()">🔍 試合情報を取得</button>

          <div class="loading" id="current-loading">⏳ 読み込み中...</div>
          <div class="error" id="current-error"></div>
          <div class="result" id="current-result"></div>
        </div>
      </div>

      <!-- 組み分けタブ -->
      <div id="balance-teams" class="tab-content">
        <div class="content-card">
          <div class="info-box">
            💡
            カスタムゲームに参加する10人のサモナーネームを入力してください。<br />
            ランク情報を基に公平な5vs5のチーム分けを行います。
          </div>

          <div class="input-group">
            <label
              >👥
              プレイヤーリスト（1行に1人、ゲーム名#タグライン形式で入力）</label
            >
            <textarea
              id="balance-players"
              placeholder="例:&#10;Player1#JP1&#10;Player2#JP1&#10;Player3#JP1&#10;...&#10;Player10#JP1"
            ></textarea>
          </div>

          <button onclick="balanceTeams()">⚖️ チームを組み分け</button>

          <div class="loading" id="balance-loading">⏳ 読み込み中...</div>
          <div class="error" id="balance-error"></div>
          <div class="result" id="balance-result"></div>
        </div>
      </div>

      <!-- ルーンタブ -->
      <div id="runes" class="tab-content">
        <div class="content-card">
          <div class="info-box">
            🎨 League of Legendsのルーンページを作成・保存できます。<br />
            メインツリーとサブツリーを選択し、統計シャードを設定してください。
          </div>

          <!-- ルーンページコントロール -->
          <div class="rune-page-controls">
            <input
              type="text"
              id="rune-page-name"
              class="rune-page-name-input"
              placeholder="ルーンページ名を入力..."
              value="新しいルーンページ"
            />
            <button onclick="saveRunePage()">💾 ページ保存</button>
            <button onclick="resetRunePage()">🔄 リセット</button>
            <button onclick="toggleSavedPages()">
              📚 保存済み (<span id="saved-pages-count">0</span>)
            </button>
          </div>

          <!-- 保存済みページ表示エリア -->
          <div id="saved-pages-container" style="display: none">
            <div class="saved-rune-pages">
              <h3>💾 保存済みルーンページ</h3>
              <div id="saved-pages-list"></div>
            </div>
          </div>

          <div class="loading" id="runes-loading">
            ⏳ ルーンデータを読み込み中...
          </div>
          <div class="error" id="runes-error"></div>

          <div id="runes-content" style="display: none">
            <!-- ルーン概要 -->
            <div class="rune-page-summary">
              <h3>📋 現在の設定</h3>
              <p>メインツリー: <strong id="summary-primary">未選択</strong></p>
              <p>サブツリー: <strong id="summary-secondary">未選択</strong></p>
              <p>
                選択済みルーン: メイン
                <strong id="summary-primary-runes">0/4</strong> サブ
                <strong id="summary-secondary-runes">0/2</strong> シャード
                <strong id="summary-shards">0/3</strong>
              </p>
            </div>

            <!-- ルーンビルダー -->
            <div class="rune-builder-container">
              <!-- メインツリー -->
              <div class="rune-builder-section">
                <h3>⚡ メインツリー</h3>
                <div id="primary-tree-selector" class="rune-tree-selector"></div>
                <div id="primary-rune-slots"></div>
              </div>

              <!-- サブツリー -->
              <div class="rune-builder-section">
                <h3>💫 サブツリー</h3>
                <div
                  id="secondary-tree-selector"
                  class="rune-tree-selector"
                ></div>
                <div id="secondary-rune-slots"></div>
              </div>
            </div>

            <!-- 統計シャード -->
            <div class="stat-shards-container">
              <h3>📊 統計シャード</h3>
              <div id="stat-shards" class="stat-shards-grid"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- チャンピオンタブ -->
      <div id="champions" class="tab-content">
        <div class="content-card">
          <div class="info-box">
            🏆 全チャンピオンの詳細情報、スキル、ステータスを確認できます。<br />
            チャンピオン名、ロール、レーン、難易度でフィルタリングできます。
          </div>

          <!-- フィルターセクション -->
          <div class="compact-filters">
            <div
              class="compact-filters-header"
              onclick="toggleFiltersSection(this)"
            >
              <h3>
                <span class="toggle-icon">🔽</span>
                検索・フィルター
              </h3>
              <span style="color: #a0aec0; font-size: 0.9rem"
                >クリックで展開/折りたたみ</span
              >
            </div>

            <div class="filters-content">
              <!-- 左カラム -->
              <div class="filter-section">
                <div class="input-group">
                  <label>🔍 チャンピオン検索</label>
                  <input
                    type="text"
                    id="champion-search"
                    placeholder="チャンピオン名、タイトル、説明で検索..."
                  />
                </div>

                <div class="input-group">
                  <label>🎭 ロールフィルター（複数選択可）</label>
                  <div
                    id="champion-roles-filter"
                    class="tags-filter tags-filter-compact"
                  ></div>
                </div>

                <div class="input-group">
                  <label>🛣️ レーンフィルター（複数選択可）</label>
                  <div
                    id="champion-lanes-filter"
                    class="tags-filter tags-filter-compact"
                  ></div>
                </div>
              </div>

              <!-- 右カラム -->
              <div class="filter-section">
                <div class="input-group">
                  <label>⚔️ 難易度フィルター（複数選択可）</label>
                  <div
                    id="champion-difficulty-filter"
                    class="tags-filter tags-filter-compact"
                  ></div>
                </div>

                <div class="input-group">
                  <label>📊 並び替え</label>
                  <select id="champion-sort">
                    <option value="name-asc">名前 (昇順)</option>
                    <option value="difficulty-asc">難易度 (低い順)</option>
                    <option value="difficulty-desc">難易度 (高い順)</option>
                  </select>
                </div>

                <div class="input-group">
                  <button
                    onclick="clearChampionFilters()"
                    style="
                      width: 100%;
                      background: rgba(239, 68, 68, 0.8);
                    "
                  >
                    🗑️ フィルターをクリア
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="champion-stats">
            <p>表示中: <span id="champions-count">0</span> 体</p>
          </div>

          <div class="loading" id="champions-loading">
            ⏳ チャンピオンデータを読み込み中...
          </div>
          <div class="error" id="champions-error"></div>
          <div id="champions-grid" style="display: none"></div>
        </div>
      </div>

      <!-- アイテムタブ -->
      <div id="items" class="tab-content">
        <div class="content-card">
          <div class="info-box">
            🗡️ 全アイテムの詳細情報を確認できます。<br />
            価格、マップ、タグ、キーワードでフィルタリングして、ビルドを作成できます。
          </div>

          <!-- ビルドコントロール -->
          <div class="build-controls">
            <input
              type="text"
              id="build-name"
              placeholder="ビルド名を入力..."
              value="カスタムビルド"
            />
            <button onclick="toggleBuildPanel()">
              🎒 ビルド (<span id="build-items-count">0</span>)
            </button>
            <button onclick="saveBuild()">💾 ビルド保存</button>
            <button onclick="toggleSavedBuilds()">
              📚 保存済み (<span id="saved-builds-count">0</span>)
            </button>
          </div>

          <!-- 保存済みビルド表示エリア -->
          <div id="saved-builds-container" style="display: none; margin-top: 20px;">
            <div class="saved-builds-panel">
              <h3>💾 保存済みビルド</h3>
              <div id="saved-builds-list"></div>
            </div>
          </div>

          <!-- ビルドパネル -->
          <div id="build-panel" class="build-panel">
            <div class="build-panel-content">
              <div class="build-panel-header">
                <h3>🎒 現在のビルド</h3>
                <button onclick="toggleBuildPanel()">✕</button>
              </div>
              <div class="build-sections">
                <div class="build-section">
                  <h4>スターターアイテム</h4>
                  <div id="build-start-items" class="build-items-grid"></div>
                </div>
                <div class="build-section">
                  <h4>コアアイテム（最大6個）</h4>
                  <div id="build-core-items" class="build-items-grid"></div>
                </div>
                <div class="build-section">
                  <h4>状況対応アイテム</h4>
                  <div
                    id="build-situational-items"
                    class="build-items-grid"
                  ></div>
                </div>
              </div>
              <div class="build-panel-actions">
                <button onclick="downloadBuild()">
                  ⬇️ ダウンロード (.json)
                </button>
                <button onclick="copyBuildToClipboard()">📋 コピー</button>
                <button onclick="clearBuild()">🗑️ クリア</button>
              </div>
            </div>
          </div>

          <!-- フィルターセクション -->
          <div class="compact-filters">
            <div
              class="compact-filters-header"
              onclick="toggleFiltersSection(this)"
            >
              <h3>
                <span class="toggle-icon">🔽</span>
                検索・フィルター
              </h3>
              <span style="color: #a0aec0; font-size: 0.9rem"
                >クリックで展開/折りたたみ</span
              >
            </div>

            <div class="filters-content">
              <!-- 左カラム -->
              <div class="filter-section">
                <div class="input-group">
                  <label>🔍 キーワード検索</label>
                  <input
                    type="text"
                    id="item-search"
                    placeholder="アイテム名、説明で検索..."
                  />
                </div>

                <div class="input-group">
                  <label>🏷️ タグフィルター（複数選択可）</label>
                  <div
                    id="item-tags-filter"
                    class="tags-filter tags-filter-compact"
                  ></div>
                </div>

                <div class="filter-row">
                  <div class="input-group">
                    <label>💰 最低価格</label>
                    <input
                      type="number"
                      id="item-price-min"
                      value="0"
                      min="0"
                      placeholder="0"
                    />
                  </div>

                  <div class="input-group">
                    <label>💰 最高価格</label>
                    <input
                      type="number"
                      id="item-price-max"
                      value="10000"
                      min="0"
                      placeholder="10000"
                    />
                  </div>
                </div>
              </div>

              <!-- 右カラム -->
              <div class="filter-section">
                <div class="filter-row">
                  <div class="input-group">
                    <label>🗺️ マップ</label>
                    <select id="item-map">
                      <option value="all">すべて</option>
                      <option value="11">サモナーズリフト</option>
                      <option value="12">ハウリングアビス</option>
                      <option value="30">アリーナ</option>
                    </select>
                  </div>

                  <div class="input-group">
                    <label>📊 並び替え</label>
                    <select id="item-sort">
                      <option value="name-asc">名前 (昇順)</option>
                      <option value="price-asc">価格 (安い順)</option>
                      <option value="price-desc">価格 (高い順)</option>
                    </select>
                  </div>
                </div>

                <div class="input-group">
                  <label style="display: flex; align-items: center; gap: 8px">
                    <input type="checkbox" id="item-purchasable" checked />
                    購入可能なアイテムのみ表示
                  </label>
                </div>

                <div class="input-group">
                  <button
                    onclick="clearItemFilters()"
                    style="
                      width: 100%;
                      background: rgba(239, 68, 68, 0.8);
                    "
                  >
                    🗑️ フィルターをクリア
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="items-stats">
            <p>表示中: <span id="items-count">0</span> 個</p>
          </div>

          <div class="loading" id="items-loading">
            ⏳ アイテムデータを読み込み中...
          </div>
          <div class="error" id="items-error"></div>
          <div id="items-grid" style="display: none"></div>
        </div>
      </div>
    </div>

    <!-- モーダル -->
    <div id="modal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2 id="modal-title"></h2>
        <div class="modal-body" id="modal-body"></div>
      </div>
    </div>

    <!-- JavaScript ファイル読み込み -->
    <script src="static/js/ui.js"></script>
    <script src="static/js/api.js"></script>
    <script src="static/js/runes.js"></script>
    <script src="static/js/champions.js"></script>
    <script src="static/js/items.js"></script>
    <script src="static/js/main.js"></script>
  </body>
</html>
